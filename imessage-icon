#!/bin/sh

# https://github.com/davidfmiller/bin/

if [[ "`which sips`" = "" ]]
then 
  >&2 echo "ğŸš«  OS X only"
  exit 1
fi

if [[ "$1" = "" ]]
then
  >&2 echo "ğŸš«  No icon file provided"
  exit 1
fi


if [ ! -e "$1" ]
then
  >&2 echo "ğŸš«  Invalid icon provided"
  exit 1
fi

filename=$(basename "$1")
extension="${filename##*.}"
target="$HOME/Desktop/${filename%.*}"

if [ -d "$target" ]
then
  echo "ğŸš«  Destination folder '$target' already exists"
  exit 1
fi

mkdir "$target"

# messages iphone
sips -Z 120 "$1" --out "$target/60x45@2x.${extension}"
sips -Z 180 "$1" --out "$target/60x45@3x.${extension}"

# messages ipad
sips -z 100 134 "$1" --out "$target/67x50@2x.${extension}"

# messages ipad pro
sips -z 110 148 "$1" --out "$target/74x55@2x.${extension}"

# messages
sips -Z 54 "$1" --out "$target/27x20@2x.${extension}"
sips -Z 81 "$1" --out "$target/27x20@3x.${extension}"

# messages
sips -Z 64 "$1" --out "$target/32x24@2x.${extension}"
sips -Z 96 "$1" --out "$target/32x24@3x.${extension}"

# messages app store
sips -Z 1024 "$1" --out "$target/1024x768.${extension}"

echo "# imessage-icon\n\nGenerated by [imessage-icon](https://github.com/davidfmiller/bin/imessage-icon)" > "$target/readme.md"

open "$target"