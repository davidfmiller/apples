#!/bin/sh

# https://github.com/davidfmiller/bin/

if [[ "`which sips`" = "" ]]
then 
  >&2 echo "ğŸš«  OS X only"
  exit 1
fi

if [[ "$1" = "" ]]
then
  >&2 echo "ğŸš«  No icon file provided"
  exit 1
fi


if [ ! -e "$1" ]
then
  >&2 echo "ğŸš«  Invalid icon provided"
  exit 1
fi

filename=$(basename "$1")
extension="${filename##*.}"
target="$HOME/Desktop/${filename%.*}-complication"

if [ -d "$target" ]
then
  echo "ğŸš«  Destination folder '$target' already exists"
  exit 1
fi

mkdir "$target"

# circular
sips -Z 32 "$1" --out "$target/circular-38mm.${extension}"
sips -Z 36 "$1" --out "$target/circular-42mm.${extension}"

# modular
sips -Z 52 "$1" --out "$target/modular-38mm.${extension}"
sips -Z 58 "$1" --out "$target/modular-42mm.${extension}"

# utility
sips -Z 40 "$1" --out "$target/utility-38mm.${extension}"
sips -Z 44 "$1" --out "$target/utility-42mm.${extension}"

# extra large
sips -Z 182 "$1" --out "$target/extralarge-38mm.${extension}"
sips -Z 203 "$1" --out "$target/extralarge-42mm.${extension}"

echo "# watchos-complication-icon\n\nGenerated by [watchos-complication-icon](https://github.com/davidfmiller/bin/)" > "$target/readme.md"

open "$target"