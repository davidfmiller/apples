#!/usr/bin/swift

import Darwin
import Cocoa
import Foundation

let stderr = NSFileHandle.fileHandleWithStandardError()

var target = "basso" // default

// map of sound name to duration
let SOUNDS : [String : Double] = [
    "basso" : 0.3,
    "blow" : 0.5,
    "frog" : 0.1,
    "funk" : 0.1,
    "glass" : 0.2,
    "hero" : 0.5,
    "morse" : 0.1,
    "ping" : 0.3,
    "pop" : 0.1,
    "purr" : 0.8,
    "sosumi" : 0.2,
    "submarine" : 1,
    "tink" : 0.1
]

if Process.arguments.count == 2
{
    target = Process.arguments[1]
}
else if Process.arguments.count > 2
{
    stderr.writeData("ðŸš«  Invalid usage\n".dataUsingEncoding(NSUTF8StringEncoding)!)
    exit(0)
}

if SOUNDS[target] == nil
{
    stderr.writeData("ðŸš«  No beep named \"\(target)\"\n".dataUsingEncoding(NSUTF8StringEncoding)!)
    exit(0)
}

let url : NSURL? = NSURL(string: "file:///System/Library/Sounds/\(target.capitalizedString).aiff")

let sound : NSSound! = NSSound(contentsOfURL: url!, byReference: false)
sound.play()

// pause script to ensure entire duration of sound is played
let future : NSDate = NSDate(timeIntervalSinceNow: SOUNDS[target]!)
NSThread.sleepUntilDate(future);
