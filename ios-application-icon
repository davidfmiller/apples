#!/bin/sh

# https://github.com/davidfmiller/bin/

if [[ "`which sips`" = "" ]]
then 
  >&2 echo "ğŸš«  OS X only"
  exit 1
fi

if [[ "$1" = "" ]]
then
  >&2 echo "ğŸš«  No icon file provided"
  exit 1
fi


if [ ! -e "$1" ]
then
  >&2 echo "ğŸš«  Invalid icon provided"
  exit 1
fi

filename=$(basename "$1")
extension="${filename##*.}"
target="$HOME/Desktop/${filename%.*}"

if [ -d "$target" ]
then
  echo "ğŸš«  Destination folder '$target' already exists"
  exit 1
fi

mkdir "$target"

# iphone & ipad notification (ios 7 - 10)
sips -Z 20 "$1" --out "$target/20.${extension}"
sips -Z 40 "$1" --out "$target/20@2x.${extension}"
sips -Z 60 "$1" --out "$target/20@3x.${extension}"


# iphone spotlight (ios 5,6), settings (ios 5-9)
sips -Z 58 "$1" --out "$target/29@2x.${extension}"
sips -Z 87 "$1" --out "$target/29@3x.${extension}"

# iphone spotlight (ios 7-9)
sips -Z 80 "$1" --out "$target/40@2x.${extension}"
sips -Z 120 "$1" --out "$target/40@3x.${extension}"

# iphone app (ios 7-9)
sips -Z 120 "$1" --out "$target/60@2x.${extension}"
sips -Z 180 "$1" --out "$target/60@3x.${extension}"

# ipad settings (ios 5-9)
sips -Z 29 "$1" --out "$target/29.${extension}"
sips -Z 58 "$1" --out "$target/29@2x.${extension}"

# ipad spotlight (ios 7-9)
sips -Z 40 "$1" --out "$target/40.${extension}"
sips -Z 80 "$1" --out "$target/40@2x.${extension}"

# ipad spotlight (ios 7-9)
sips -Z 40 "$1" --out "$target/40.${extension}"
sips -Z 80 "$1" --out "$target/40@2x.${extension}"

# ipad app (ios 7-9)
sips -Z 76 "$1" --out "$target/76.${extension}"
sips -Z 152 "$1" --out "$target/76@2x.${extension}"

# ipad pro app (ios 9)
sips -Z 167 "$1" --out "$target/83.5@2x.${extension}"

# app store
sips -Z 1024 "$1" --out "$target/1024.${extension}"

echo "# ios-icon\n\nGenerated by [ios-icon](https://github.com/davidfmiller/bin/)" > "$target/readme.md"

open "$target"